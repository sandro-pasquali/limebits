<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >
  <head>
    <style type="text/css">
      body {
        overflow: auto;
        overflow-x: auto;  
      }
      
    .CodeMirror-line-numbers {
      font-size: 10pt;
      margin-top: .4em;
      padding: 0;
      font-family: monospace;
      color: black;
    }
    </style>
      
    <script src="js/codemirror.js" type="text/javascript"></script>
    <title></title>
    <script type="text/javascript" src="/!lime/root/library/limebits/latest/axis/AXIS.js" 
    arguments="CSSReset" 
    extensions="DOM"
    ></script>
    <script type="text/javascript">
      AXIS.onResize.subscribe({
        callback: function() {
          // console.log('resized');
          // var d = document.getElementById('centerer');
          // var c = this.viewCenter(d.style);
          // d.style.left = c.x + 'px';
          // d.style.top = c.y + 'px';
         
          var ws = this.windowSize();
          var ec = this.getElHeight(AXIS.find('editor_controls'));
        
          var cm = AXIS.find('code');
          var cms = cm.style;
          cms.width = ws.width + 'px';
          cms.height = ws.height - ec + 'px';
          
         // cms.width = top.$AXIS.Modules.yahoo.Layout.view.get('width') + 'px';
         // cms.height = top.$AXIS.Modules.yahoo.Layout.view.get('height') + 'px';

          },
        scope: AXIS.DOM
      });
      
      AXIS.onDOMReady.subscribe({
        callback: function() {
          
          AXIS.onResize.fire();
          
          AXIS.createNamespace('CodeMirror');
          $AXIS.CodeMirror = CodeMirror.fromTextArea('code', {
            height:           "500px",
            //width:          "100px",
            parserfile:       [
                                "parsexml.js", 
                                "parsecss.js", 
                                "tokenizejavascript.js", 
                                "parsejavascript.js", 
                                "parsehtmlmixed.js"
                              ],
            stylesheet:       [
                                "css/xmlcolors.css", 
                                "css/jscolors.css", 
                                "css/csscolors.css"
                              ],
            path:             "js/",
            lineNumbers:      true,
            indentUnit:       2,
            tabMode:          'shift',
            //textWrapping:     true, // op
            autoMatchParens:  true, // op
            
            saveFunction:     function() {
              //console.log('save');
            },
            
            cursorActivity:   function() {
              var c     = $AXIS.CodeMirror
              var cp    = c.cursorPosition()
              var ln    = c.lineNumber(cp.line);
              var cc    = cp.character;
            
              //console.log(ln + ' - ' + cc);
              //top.$AXIS.CodeMirror.frame.frameDocument.getElementById('editor_cursor_position').innerHTML = ln + ' - ' + cc;
            }
          });
        }
      });
      
    </script>
  </head>
  <body>

<div id="editor_controls" style="width:100%; height:32px; border:1px black solid;">
</div>
<textarea id="code" style="">
&lt;html>
  &lt;head>
    &lt;title>HTML Example&lt;/title>
    &lt;script type="text/javascript">
      function foo(bar, baz) {
        alert("quux");
        return bar + baz + 1;
      }
    &lt;/script>
    &lt;style type="text/css">
      div.border {
        border: 1px solid black;
        padding: 3px;
      }
      #foo code {
        font-family: courier, monospace;
        font-size: 80%;
        color: #448888;
      }
    &lt;/style>
  &lt;/head>
  &lt;body>
    &lt;p>Duh&lt;/p>
  &lt;/body>
&lt;/html>
</textarea>

<!--
<div id="centerer" style="position:absolute; top:0px; left:0px; width:100px; height:100px; background-color:red;"></div>
-->

<script type="text/javascript">

</script>
  </body>
</html>
